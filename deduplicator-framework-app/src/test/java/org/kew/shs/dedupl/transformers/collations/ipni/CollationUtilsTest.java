package org.kew.shs.dedupl.transformers.collations.ipni;

import static org.junit.Assert.assertEquals;

import java.util.Arrays;
import java.util.Collection;

import org.junit.Before;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;

@RunWith(Parameterized.class)
public class CollationUtilsTest {

	   private String collation;
	   private String  expectedSer;
	   private String  expectedVol;
	   private String  expectedIssue;
	   private String  expectedPage;
	   private String  expectedTabOrFig;
	   private String  expectedYear;
	   private String  expectedRule;
	   
	   private CollationUtils cu;

	   @Before
	   public void initialize() {
	      cu = new CollationUtils();
	   }

	   // Each parameter should be placed as an argument here
	   // Every time runner triggers, it will pass the arguments
	   // from parameters we defined in collations() method
	   public CollationUtilsTest(String collation
			   , String expectedSer
			   , String expectedVol
			   , String expectedIssue
			   , String expectedPage
			   , String expectedTabOrFig
			   , String expectedYear
			   , String expectedRule
			   ) {
	      this.collation = collation;
	      this.expectedSer= expectedSer;
	      this.expectedVol = expectedVol;
	      this.expectedIssue=expectedIssue;
	      this.expectedPage=expectedPage;
	      this.expectedTabOrFig=expectedTabOrFig;
	      this.expectedYear=expectedYear;
	      this.expectedRule=expectedRule;
	   }

	   @Parameterized.Parameters
	   public static Collection collations() {
	      return Arrays.asList(new Object[][] {
	    		  	{ ""							, ""	, ""	, ""		, ""		, ""	, ""	, ""}

	    		  , {"7"							, ""	, ""	, ""		, "7"		, ""	, ""	, "1"}
	    		  , {"7."							, ""	, ""	, ""		, "7"		, ""	, ""	, "1"}
	    		  , {"106 (-107)"					, ""	, ""	, ""		, "106"		, ""	, ""	, "1"}
	    		  
	    		  , {"1: 7"							, ""	, "1"	, ""		, "7"		, ""	, ""	, "3"}
	    		  , {"1: 7, in obs."				, ""	, "1"	, ""		, "7"		, ""	, ""	, "3"}
	    		  , {"1: 7, without basionym ref."	, ""	, "1"	, ""		, "7"		, ""	, ""	, "3"}
	    		  , {"1:7"							, ""	, "1"	, ""		, "7"		, ""	, ""	, "3"}
	    		  , {"III: 31"						, ""	, "III"	, ""		, "31"		, ""	, ""	, "3"}
	    		  , {"139a: 116"					, ""	, "139a"	, ""	, "116"		, ""	, ""	, "3"}
	    		  , {"1899: 116"					, ""	, "1899"	, ""	, "116"		, ""	, ""	, "3"}
	    		  , {"103-106: 61"					, ""	, "103-106"	, ""	, "61"		, ""	, ""	, "3"}
	    		  , {"2012-87: 28"					, ""	, "2012-87"	, ""	, "28"		, ""	, ""	, "3"}
	    		  , {"1987: 9"						, ""	, "1987"	, ""	, "9"		, ""	, ""	, "3"}

	    		  // Tests of various kinds of dashes:
	    		  , {"1:2\u20123"							, ""	, "1"	, ""		, "2-3"		, ""	, ""	, "3"}
	    		  , {"1:4\u20125"							, ""	, "1"	, ""		, "4-5"		, ""	, ""	, "3"}
	    		  , {"1:6\u20127"							, ""	, "1"	, ""		, "6-7"		, ""	, ""	, "3"}
	    		  
	    		  , {"1(2):7"								, ""	, "1"		, "2"		, "7"		, ""	, ""	, "4"}
	    		  , {"1(2):1901"							, ""	, "1"		, "2"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1(2A):1901"							, ""	, "1"		, "2A"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1(11-12): 653"						, ""	, "1"		, "11-12"	, "653"		, ""	, ""	, "4"}
	    		  , {"1(2-3):1901"							, ""	, "1"		, "2-3"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1(4.5):191"							, ""	, "1"		, "4.5"		, "191"		, ""	, ""	, "65.4"}
	    		  , {"1(2):191(-3)"							, ""	, "1"		, "2"		, "191"		, ""	, ""	, "4"}
	    		  , {"1(2):1901(-3)"						, ""	, "1"		, "2"		, "1901"	, ""	, ""	, "4"}
	    		  , {"20A(15): 41"							, ""	, "20A"		, "15"		, "41"		, ""	, ""	, "4"}
	    		  , {"20A(15-16): 41"						, ""	, "20A"		, "15-16"	, "41"		, ""	, ""	, "4"}
	    		  , {"IV(134): 104"							, ""	, "IV"		, "134"		, "104"		, ""	, ""	, "4"}
	    		  , {"1892(9): 425"							, ""	, "1892"	, "9"		, "425"		, ""	, ""	, "4"}
	    		  , {"1871(2-3):1901"						, ""	, "1871"	, "2-3"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1872(2):191(-3)"						, ""	, "1872"	, "2"		, "191"		, ""	, ""	, "4"}
	    		  , {"1873(2):1901(-3)"						, ""	, "1873"	, "2"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1874(2):1901, nom. nov."				, ""	, "1874"	, "2"		, "1901"	, ""	, ""	, "4"}
	    		  , {"1875(2):191, without basionym ref."	, ""	, "1875"	, "2"		, "191"		, ""	, ""	, "4"}
	    		  , {"1(1): 143 (-144)"						, ""	, "1"		, "1"		, "143"		, ""	, ""	, "4"}
	    		  , {"1874(2):1901, in nota."				, ""	, "1874"	, "2"		, "1901"	, ""	, ""	, "4"}
	    		  
	    		  , {"1(2): 45 (1901)"				, ""	, "1"		, "2"	, "45"	, ""	, "1901"	, "5"}
	    		  , {"1(2): 45 (1901):"				, ""	, "1"		, "2"	, "45"	, ""	, "1901"	, "5"}
	    		  , {"112(7-8): 484 (2001)"			, ""	, "112"		, "7-8"	, "484"	, ""	, "2001"	, "5"}
	    		  , {"10(1): 97 (1982), nom. nov."	, ""	, "10"		, "1"	, "97"	, ""	, "1982"	, "5"}
	    		  , {"1949(1): 35 (1949)"			, ""	, "1949"	, "1"	, "35"	, ""	, "1949"	, "5"}

	    		  , {"C: 335 (1895)"				, ""	, "C"	, ""	, "335"		, ""	, "1895"	, "5.1"}
	    		  , {"xvi. 56 (1901)"				, ""	, "xvi"	, ""	, "56"		, ""	, "1901"	, "5.1"}
	    		  , {"xvi. 56 (1902)."				, ""	, "xvi"	, ""	, "56"		, ""	, "1902"	, "5.1"}
	    		  , {"C. 93 (1903)"					, ""	, "C"	, ""	, "93"		, ""	, "1903"	, "5.1"}
	    		  , {"C. 93(1904)."					, ""	, "C"	, ""	, "93"		, ""	, "1904"	, "5.1"}
	    		  , {"ix. 3352 (1905), anglice."	, ""	, "ix"	, ""	, "3352"	, ""	, "1905"	, "5.1"}
	    		  , {"C. 433 (1895)"				, ""	, "C"	, ""	, "433"		, ""	, "1895"	, "5.1"}
	    		  , {"99: 114 (1989)"				,""		,"99"	,""		,"114"		,""		,"1989"		,"5.1"}
	    		  , {"99: 114 (1989) nom. nov."		,""		,"99"	,""		,"114"		,""		,"1989"		,"5.1"}
	    		  
	    		  
	    		  , {"C. 367"	, ""	, "C"	, ""	, "367"	, ""	, ""	, "6"}
	    		  , {"xvi. 56"	, ""	, "xvi"	, ""	, "56"	, ""	, ""	, "6"}
	    		  , {"xvi. 56, nom. nov."	, ""	, "xvi"	, ""	, "56"	, ""	, ""	, "6"}
	    		  , {"xvi. 56, without basionym ref."	, ""	, "xvi"	, ""	, "56"	, ""	, ""	, "6"}
	    		  
	    		  , {"12, pt. 4: 79"	, ""	, "12"	, "4"	, "79"	, ""	, ""	, "9"}
	    		  , {"1, Abt. 4: 168"	, ""	, "1"	, "4"	, "168"	, ""	, ""	, "9"}
	    		  
	    		  , {"1[2]:1901"	, ""	, "1"	, "2"	, "1901"	, ""	, ""	, "4"}
	    		  , {"1[2A]:1901"	, ""	, "1"	, "2A"	, "1901"	, ""	, ""	, "4"}
	    		  , {"1[2-3]:1901"	, ""	, "1"	, "2-3"	, "1901"	, ""	, ""	, "4"}
	    		  , {"1[2]: 19"		, ""	, "1"	, "2"	, "19"		, ""	, ""	, "4"}
	    		  , {"1[2A]: 19"	, ""	, "1"	, "2A"	, "19"		, ""	, ""	, "4"}
	    		  , {"1[2-3]: 19"	, ""	, "1"	, "2-3"	, "19"		, ""	, ""	, "4"}
	    		  , {"1[2]:7"		, ""	, "1"		, "2"		, "7"		, ""	, ""	, "4"}
	    		  , {"1[2]:1999"	, ""	, "1"		, "2"		, "1999"	, ""	, ""	, "4"}
	    		  
	    		  , {"1901, xv. 58"	, ""	, "xv"	, ""	, "58"		, ""	, "1901"	, "15"}
	    		  , {"(1901), xv. 58"	, ""	, "xv"	, ""	, "58"		, ""	, "1901"	, "17"}
	    		  
	    		  , {"1901, 58"	, ""	, ""	, ""	, "58"		, ""	, "1901"	, "20"}
	    		  
	    		  , {"123:45(-7)"	, ""	, "123"	, ""	, "45"		, ""	, ""	, "22"}
	    		  
	    		  , {"123. 56. 1901"	, ""	, "123"	, ""	, "56"		, ""	, "1901"	, "24"}
	    		  , {"123. 56. 1901."	, ""	, "123"	, ""	, "56"		, ""	, "1901"	, "24"}
	    		  
	    		  , {"1(5-6, Beibl. 4): 19"		, ""	, "1"	, "5-6, Beibl. 4"	, "19"	, ""	, ""	, "25"}
	    		  , {"14(4, Beibl. 32): 4 "		, ""	, "14"	, "4, Beibl. 32"	, "4"	, ""	, ""	, "25"}
	    		  , {"14(4, Beibl. 32): 4-5 "	, ""	, "14"	, "4, Beibl. 32"	, "4-5"	, ""	, ""	, "25"}

	    		  , {"1: 45, t. 7"		, ""	, "1"	, ""	, "45"		, "t. 7"	, "", "28"}
	    		  , {"1: 1901, t. 7"	, ""	, "1"	, ""	, "1901"	, "t. 7"	, "", "28"}
	    		  , {"1: 10-11, t. 2"	, ""	, "1"	, ""	, "10-11"	, "t. 2"	, "", "28"}
	    		  , {"1: 10, t. 2-3"	, ""	, "1"	, ""	, "10"		, "t. 2-3"	, "", "28"}
	    		  , {"1: 10, t. 2"		, ""	, "1"	, ""	, "10"		, "t. 2"	, "", "28"}
	    		  , {"v. 105. t. 440."	, ""	, "v"	, ""	, "105"		, "t. 440"	, "", "28"}
	    		  , {"10: 147, fig. 1-2", ""	, "10"	, ""	, "147"		, "fig. 1-2", "", "28"}
	    		  , {"95: 143 (fig. 134)", ""	, "95"	, ""	, "143"		, "fig. 134", "", "28"}
	    		  
	    		  , {"1: 10, t. 2, 5"		, ""	, "1"	, ""	, "10"		, "t. 2, 5"	, "", "28.1"}
	    		  , {"1: 31, fig. 31, 32", ""	, "1"	, ""	, "31"		, "fig. 31, 32", "", "28.1"}
	    		  
	    		  , {"98: 43 (-45; fig. 20)", ""	, "98"	, ""	, "43-45"		, "fig. 20", "", "28.2"}
	    		  
	    		  , {"xv (1904) 23", ""	, "xv"	, ""	, "23"		, "", "1904", "29"}
	    		  , {"xlv (1895) 200"	,""	,"xlv"	,""	,"200"	,""	,"1895"	,"29"}
	    		  , {"C. (1895) 375", ""	, "C"	, ""	, "375"		, "", "1895", "29"}
	    		  
	    		  , {"1858, 23 (1859)", ""	, "1858"	, ""	, "23"		, "", "1859", "30"}
	    		  , {"1893, 182 (1894)"	, "", "1893", "", "182", "", "1894", "30"}
	    		  , {"1893,182(1894)"	, "", "1893", "", "182", "", "1894", "30"}

	    		  , {"12: 132(-3), fig", ""	, "12"	, ""	, "132"		, "", "", "32"}
	    		  
	    		  , {"12: 132, 140", ""	, "12"	, ""	, "132"		, "", "", "33"}

	    		  , {"12(1): 13 (1987), nom. nov.:"	, ""	, "12"	, "1"	, "13"		, "", "1987", "34"}
	    		  , {"60(3-4): 359 (1981)"			, ""	, "60"	, "3-4"	, "359"		, "", "1981", "5"}
	    		  
	    		  , {"1(1): 217 (-219; fig. 11)", ""	, "1"	, "1"	, "217"		, "fig. 11", "", "35"}
	    		  
	    		  , {"30: 101 (1859-61)", ""	, "30"	, ""	, "101"		, "", "1859", "36"}
	    		  
	    		  , {"1, pt. 2: 112, tab. 5, fig. 2"	, ""	, "1", "2", "112", "tab. 5, fig. 2", "", "38"}

	    		  , {"9: 112, tab. 2, fig. 2"	,""	,"9"	,""	,"112"	,"tab. 2, fig. 2"	,""	,"38.1"}
	    		  , {"9: 112, tab. 2-5, pl. 1"	,""	,"9"	,""	,"112"	,"tab. 2-5, pl. 1"	,""	,"38.1"}
	    		  , {"10: 179, tab. 17, fig. 1-7"	,""	,"10"	,""	,"179"	,"tab. 17, fig. 1-7"	,""	,"38.1"}
	    		  	    		  
	    		  , {"C. 433 (1895), in obs."	, "", "C", "", "433", "", "1895", "40"}

	    		  , {"24(Misc.): 71"	, ""	, "24(Misc.)"	, ""	, "71"	, ""	, ""	, "45"}
	    		  
	    		  , {"101. 1858."	, "", "", "", "101", "", "1858", "46"}
	    		  , {"7 (1932)."	, "", "", "", "7", "", "1932", "46"}


	    		  , {"14(3): 707, fig. 2"	, "", "14", "3", "707", "fig. 2", "", "48"}
	    		  , {"14(3): 707, pl. 2"	, "", "14", "3", "707", "pl. 2"	, "", "48"}
	    		  , {"14(3): 707, t. 2"		, "", "14", "3", "707", "t. 2"	, "", "48"}
	    		  , {"1(2): 52 (t. 45)"		, "", "1", "2", "52", "t. 45"	, "", "48"}
	    		  

	    		  , {"10, no. 5: 2, pl. 1"		, "", "10", "5"		, "2", "pl. 1"	, "", "51"}
	    		  , {"10, no. 5-6: 2, pl. 1"	, "", "10", "5-6"	, "2", "pl. 1"	, "", "51"}
	    		  , {"10, no. 5: 2, t. 1"		, "", "10", "5"		, "2", "t. 1"	, "", "51"}
	    		  , {"10, no. 5-6: 2, t. 1"		, "", "10", "5-6"	, "2", "t. 1"	, "", "51"}

	    		  , {"(1756) 249."		, "", "", ""	, "249", ""	, "1756", "52"}
	    		  
	    		  
	    		  , {"Ser. 1, 23: 89"		, "1", "23", ""	, "89", ""	, "", "55"}
	    		  , {"Ser. 1, 23: 1901"		, "1", "23", ""	, "1901", ""	, "", "55"}
	    		  , {"S\u00E9r. 1, 23: 1901"		, "1", "23", ""	, "1901", ""	, "", "55"}
	    		  
	    		  , {"Ser. 1, 23(1): 89"		, "1", "23", "1"	, "89", ""	, "", "56"}
	    		  , {"Ser. 1, 23(2): 1901"		, "1", "23", "2"	, "1901", ""	, "", "56"}
	    		  , {"S\u00E9r. 1, 23(2): 1901"		, "1", "23", "2"	, "1901", ""	, "", "56"}
	    		  
	    		  , {"Acerac. 22", "", "", "", "22", "", "", "56.1"}
	    		  	    		  
	    		  , {"V. ix. (1873) 355", "V", "ix", "", "355", "", "1873", "56.111"}
	    		  , {"v. ix. (1873) 355", "", "v", "ix", "355", "", "1873", "56.112"}

	    		  , {"ii. V. 216 (1855)"	,""		,"ii"	,"V"	,"216"	,""		,"1855"	,"56.13"}
	    		  , {"i. I. 217 (1855)"		,""		,"i"	,"I"	,"217"	,""		,"1855"	,"56.13"}

	    		  , {"1851, iii. 160 (1855).", "", "iii", "", "160", "", "1855", "56.14"}
	    		  
	    		  , {"99: t. 6043", "", "99", "", "", "t. 6043", "", "56.15"}
	    		  , {"99: t. 1901", "", "99", "", "", "t. 1901", "", "56.15"}
	    		  
	    		  , {"(Aout 1819) 98", "", "", "", "98", "", "1819", "56.17"}
	    		  
	    		  , {"ed. 11, 169"	, "ed. 11"	, ""	, ""	, "169"	, ""			, ""	, "56.21"}
	    		  , {"no. 2, 8"		, ""		, "2"	, ""	, "8"	, ""			, ""	, "56.22"}
	    		  , {"t. 81, 82"	, ""		, ""	, ""	, ""	, "t. 81, 82"	, ""	, "56.23"}

	    		  , {"No. 154, 65 (1963)", "", "154", "", "65", "", "1963", "56.3"}
	    		  , {"Fasc. 154, 65 (1963)", "", "154", "", "65", "", "1963", "56.3"}
	    		  , {"Pt. 154, 65 (1963)", "", "154", "", "65", "", "1963", "56.3"}
	    		  
	    		  , {"Ser. I, ix. 16 (1911)."		, "I", "ix", ""	, "16", ""	, "1911", "56.4"}

	    		  , {"Ser. II. i. 1074."		, "II", "i", ""	, "1074", ""	, "", "56.5"}
	    		  
	    		  , {"Orch.-Coelog. 29 (1907)","Orch.-Coelog.","","","29","","1907","56.7"}

	    		  , {"2. 1857"	,""	,""	,""	,"2"	,""	,"1857"	,"56.8"}
	    		  
	    		  , {"i. (1820) v. 28","","i","v","28","","1820","56.9"}

	    		  
	    		  , {"II. 1. 1018. 1901"	,"II"	,"1"	,""	,"1018"	,""	,"1901"	,"62"}
	    		  
	    		  , {"iii. 8 (1894) 45", "", "iii", "8", "45", "", "1894", "62.4"}
	    		  
	    		  , {"iv. 3b (1894) 227", "iv", "3b", "", "227", "", "1894", "62.5"}
	    		  

	    		  , {"50. t. 16."		, ""	, ""	, ""	, "50"		, "t. 16", "", "63.1"}
	    		  , {"150. t. 116"		, ""	, ""	, ""	, "150"		, "t. 116", "", "63.1"}
	    		  , {"125, t. 59"	,""	,""	,""	,"125"	,"t. 59"	,""	,"63.1"}
	    		  
	    		  , {"Beih. 95: 34"	, ""	, "Beih. 95"	, "", "34", "", "", "65.2"}
	    		  , {"Suppl. 95: 34", ""	, "Suppl. 95"	, "", "34", "", "", "65.2"}

	    		  , {"1(2.3): 11", ""	, "1"	, "2.3", "11", "", "", "65.4"}
	    		  , {"2(3,4): 12", ""	, "2"	, "3,4", "12", "", "", "65.4"}
	    		  , {"3(4:5): 13", ""	, "3"	, "4:5", "13", "", "", "65.4"}
	    		  , {"4(5/6): 14", ""	, "4"	, "5/6", "14", "", "", "65.4"}
	    		  
	    		  , {"93(Orchid. 25): 69", ""	, "93"	, "Orchid. 25", "69", "", "", "65.5"}
	    		  , {"15(2, Beibl.): 13", ""	, "15"	, "2, Beibl.", "13", "", "", "65.5"}
	    		  , {"4(2, Cur. Post.): 259", ""	, "4"	, "2, Cur. Post.", "259", "", "", "65.5"}
	    		  
	    		  , {"94: sub t. 5720", "", "94", "", "", "sub t. 5720", "", "65.15"}
	    		  , {"94: sub t. 1901", "", "94", "", "", "sub t. 1901", "", "65.15"}
	    		  
	    		  
	    		  , {"xxvi. t. 364"	,""	,"xxvi"	,""	,""	,"t. 364"	,""	,"65.1"}
	    		  , {"liv. B. 646"	,""	,"liv.B"	,""	,"646"	,""	,""	,"65.1"}
	    		  
	    		  
	    		  
	    		  // Check that the following indeterminate patterns are NOT parsed:
	    		  ,{"13,14","","","","","","",""}
	    		  ,{"13,14 (1901)","","","","","","",""}
	    		  ,{"13,14 (1901).","","","","","","",""}
	    		  ,{"x. 10. 13(1901)","","","","","","",""}
	    		  
	    		  
	    		  // Check that things in spreadsheet are parsed:
	    		  ,{"C. 93 (1895)"				,""			,"C"		,""					,"93"	,""				,"1895"	,"5.1"}
	    		  ,{"1, Abt. 4: 168"			,""			,"1"		,"4"				,"168"	,""				,""		,"9"}
	    		  ,{"1(11-12): 653"				,""			,"1"		,"11-12"			,"653"	,""				,""		,"4"}
	    		  ,{"14(4, Beibl. 32): 4 "		,""			,"14"		,"4, Beibl. 32"		,"4"	,""				,""		,"25"}
	    		  ,{"C. 367"					,""			,"C"		,""					,"367"	,""				,""		,"6"}
	    		  ,{"1893, 182 (1894)"			,""			,"1893"		,""					,"182"	,""				,"1894"	,"30"}
	    		  ,{"12(1-2, Beibl. 27): 14"	,""			,"12"		,"1-2, Beibl. 27"	,"14"	,""				,""		,"25"}
	    		  ,{"1: 10, t. 2"				,""			,"1"		,""					,"10"	,"t. 2"			,""		,"28"}
	    		  ,{"1913, 416 (1914)"			,""			,"1913"		,""					,"416"	,""				,"1914"	,"30"}
	    		  ,{"C. (1895) 375"				,""			,"C"		,""					,"375"	,""				,"1895"	,"29"}
	    		  ,{"C. 433 (1895), in obs."	,""			,"C"		,""					,"433"	,""				,"1895"	,"40"}
	    		  ,{"24(Misc.): 71"				,""			,"24(Misc.)",""					,"71"	,""				,""		,"45"}
	    		  ,{"14(3): 707, fig. 2"		,""			,"14"		,"3"				,"707"	,"fig. 2"		,""		,"48"}
	    		  ,{"1987: 9"					,""			,"1987"		,""					,"9"	,""				,""		,"3"}
	    		  ,{"10, no. 5: 2, pl. 1"		,""			,"10"		,"5"				,"2"	,"pl. 1"		,""		,"51"}
	    		  ,{"V. ix. (1873) 355"			,"V"		,"ix"		,""					,"355"	,""				,"1873"	,"56.111"}
	    		  ,{"vii. II. (1836) 283"		,""			,"vii"		,"II"				,"283"	,""				,"1836"	,"56.112"}
	    		  ,{"99: t. 6043"				,""			,"99"		,""					,""		,"t. 6043"		,""		,"56.15"}
	    		  ,{"ed. 11, 169"				,"ed. 11"	,""			,""					,"169"	,""				,""		,"56.21"}
	    		  ,{"no. 2, 8"					,""			,"2"			,""				,"8"		,""			,""		,"56.22"}
	    		  ,{"t. 81, 82"					,""			,""			,""					,""		,"t. 81, 82"	,""		,"56.23"}
	    		  
	    		  ,{"No. 154, 65 (1963)"		,""				,"154"	,""	,"65"	,""	,"1963"	,"56.3"}
	    		  ,{"Orch.-Coelog. 29 (1907)"	,"Orch.-Coelog.",""		,""	,"29"	,""	,"1907"	,"56.7"}
	    		  
	    		  ,{"1892(9): 425"			,""	,"1892"	,"9"	,"425"		,""					,""		,"4"}
	    		  ,{"99: 114 (1989)"		,""	,"99"	,""		,"114"		,""					,"1989"	,"5.1"}
	    		  ,{"95: 143 (fig. 134)"	,""	,"95"	,""		,"143"		,"fig. 134"			,""		,"28"}
	    		  ,{"98: 43 (-45; fig. 20)"	,""	,"98"	,""		,"43-45"	,"fig. 20"			,""		,"28.2"}
	    		  ,{"9: 112, tab. 2, fig. 2",""	,"9"	,""		,"112"		,"tab. 2, fig. 2"	,""		,"38.1"}
	    		  , {"IV(134): 104"			, "","IV"	,"134"	,"104"		,""					, ""	,"4"}
	    		  , {"C: 335 (1895)"				, ""	, "C"	, ""	, "335"		, ""	, "1895"	, "5.1"}
	    		  , {"III: 31"						, ""	, "III"	, ""		, "31"		, ""	, ""	, "3"}


	    		  ,{"ix. 3352 (1937), anglice."		,""		,"ix"	,""		,"3352","","1937","5.1"}
//	    		  ,{"v. 105. t. 440.","","","","","","",""} // See above
	    		  ,{"ix. 130, 484 (1939).","","ix","","130, 484","","1939","62.3"}
//	    		  ,{"iii. 8 (1894) 45","","","","","","",""}  // See above
//	    		  ,{"s\u00E9r. 10, 1: 206","","","","","","",""}
//	    		  ,{"Beih. 95: 34","","","","","","",""} // See above
	    		  ,{"Suppl. 9: 89","","Suppl. 9","","89","","","65.2"}
//	    		  ,{"1(1.1): 8","","","","","","",""} // See above
//	    		  ,{"93(Orchid. 25): 69","","","","","","",""}  // See above
//	    		  ,{"20A(15): 41","","","","","","",""} // See above
//	    		  ,{"s\u00E9r. 3, 21(2): 199","","","","","","",""}
//	    		  ,{"125, t. 59","","","","","","",""} // See above
//	    		  ,{"95(7-8): 460","","","","","","",""} // See above
//	    		  ,{"103-106: 61","","","","","","",""}  // See above
//	    		  ,{"xxvi. t. 364","","","","","","",""}  // See above
//	    		  ,{"liv. B. 646","","","","","","",""} // See above
	    		  ,{"Suppl., 112(1256): 28","","Suppl., 112","1256","28","","","65.10"}
//	    		  ,{"139a: 116","","","","","","",""} // See above
//	    		  ,{"60(3-4): 359 (1981)","","","","","","",""} // See above
//	    		  ,{"15(2, Beibl.): 13","","","","","","",""} // See above
	    		  ,{"1902, Ser. III. xxxii. 469.","III","xxxii","","469","","1902","67"}
//	    		  ,{"4(2, Cur. Post.): 259","","","","","","",""} // See above
	    		  ,{"160. t. 169"	,""	,""	,""	,"160"	,"t. 169"	,""	,"63.1"}
	    		  ,{"94: sub t. 5720","","94","","","sub t. 5720","","65.15"}
	    		  ,{"116(1-2): 27 (1992):","","116","1-2","27","","1992","5"}
//	    		  
	    		  ,{"104; Fl. Ind. iii. 680","","","","104","","","70"}
//	    		  
	    		  ,{"Arac.-Homalomen.-Schismatoglott. 47 (1912)","Arac.-Homalomen.-Schismatoglott.","","","47","","1912","71"}
//	    		  ,{"101. 1858.","","","","","","",""} // See above
//	    		  ,{"xlv (1895) 200","","","","","","",""} // See above
//	    		  ,{"106 (-107)","","","","","","",""} // See above
	    		  ,{"53(M\u00E9m. 3b): 129","","53","M\u00E9m. 3b","129","","","65.5"}
	    		  ,{"Pt. VII. 1068 (1936)","","VII","","1068","","1936","75.1"}
	    		  ,{"Suppl. IV. 68 (1932)","","Suppl. IV","","68","","1932","75.2"}
	    		  
	    		  ,{"17(b): 196"				,""		,"17(b)"	,""		,"196"	,""			,""		,"65.17"}
	    		  ,{"50. t. 16."				,""		,""			,""		,"50"	,"t. 16"	,""		,"63.1"}
	    		  ,{"Ser. II. vii. 590 (1907)."	,"II"	,"vii"		,""		,"590"	,""			,"1907"	,"77"}
	    		  ,{"2(1,4): 18"				,""		,"2"		,"1,4"	,"18"	,""			,""		,"65.4"}
	    		  ,{"21(4): 1963"				,""		,"21"		,"4"	,"1963"	,""			,""		,"4"}
	    		  ,{"14(10): t. 1411"			,""		,"14"		,"10"	,""		,"t. 1411"	,""		,"78"}

	    		  ,{"112(7-8): 484 (2001)","","112","7-8","484","","2001","5"}
	    		  ,{"1908, xxxv. 562 (1909)","","xxxv","","562","","1909","65.21"}
	    		  ,{"II. 1. 1018. 1901","II","1","","1018","","1901","62"}
	    		  //,{"4, Abt. 3b: 79","4","Abt. 3b","","79","","",""} // Conflicts with previous rule
	    		  
	    		  ,{"Ser. II, ii. 115 (1910)","II","ii","","115","","1910","56.4"}
	    		  ,{"xiv e. 15 (1940)","","xiv e","","15","","1940","80"}
	    		  ,{"ser. 2, 1, app. 106","2","1","","","app. 106","","81"}
	    		  ,{"2012-87: 28","","2012-87","","28","","","3"}
	    		  ,{"Ser. I, iv. (1836) 376","I","iv","","376","","1836","82"}
	    		  ,{"1949(1): 35 (1949)","","1949","1","35","","1949","5"}
	    		  ,{"vi. (1864-65) 524.","","vi","","524","","1864,1865","83"}
	    		  ,{"xviii-xix. (1861) 166"	,""	,"xviii-xix"	,""	,"166"	,""	,"1861"	,"84"}
	    		  ,{"13(10): 440 (30 Jan. 2002)","","13","10","440","","","59"}
	    		  ,{"10(1): 97 (1982), nom. nov.","","10","1","97","","1982","5"}
	    		  ,{"1(2): 52 (t. 45)","","1","2","52","t. 45","","48"}
	    		  ,{"1: 31, fig. 31, 32","","1","","31","fig. 31, 32","","28.1"}
	    		  ,{"1(19): 290, 304","","1","19","290, 304","","","62.12"}
	    		  ,{"10: 147, fig. 1-2","","10","","147","fig. 1-2","","28"}
	    		  ,{"10: 179, tab. 17, fig. 1-7","","10","","179","tab. 17, fig. 1-7","","38.1"}
	    		  ,{"i. I. 217 (1855)","","i","I","217","","1855","56.13"}
	    		  ,{"iv. 3b (1894) 227","iv","3b","","227","","1894","62.5"}
	    		  ,{"II. 237. t. 71 (1831)","","II","","237","t. 71","1831","62.6"}

	    		  ,{"iii. 261 (1945), descr. ampl.","","iii","","261","","1945","5.1"}
	    		  ,{"4, Fam. 147, II: 82","4","Fam. 147, II","","82","","","63.3"}

	    		  ,{"121, 338 (1929)","","","","","","",""} // Should not parse!

	    		  ,{"17, Heft 74: 36"	,""	,"17"	,"Heft 74"	,"36"	,""	,""	,"63.5"}
	    		  
	    		  ,{"270, 339 (1929).","","","","","","",""} // Should not parse

	    		  ,{"IV. 105(Heft 89): 341"						,"IV"	,"105"		,"Heft 89"	,"341"		,""			,""		,"62.8"}
	    		  ,{"ix. 53 (1959); cf. Gray Herb. Card Cat."	,""		,"ix"		,""			,"53"		,""			,"1959"	,"62.9"}
	    		  ,{"ix. 126, 180 (1962)"						,""		,"ix"		,""			,"126, 180"	,""			,"1962"	,"62.10"}
	    		  ,{"ii. 120. t. 190 (1827)."					,""		,"ii"		,""			,"120"		,"t. 190"	,"1827"	,"62.11"}
	    		  ,{"lxviii. 328, 417"							,""		,"lxviii"	,""			,"328, 417"	,""			,""		,"62.12"}

	    		  ,{"2, 37, no. 1: 107","","","","","","",""}

	      });
	   }

	   @Test
	   public void testCollationParsing() {
		  /*
	      System.out.println("Collation is : " + collation 
	    		  + ", series: " + expectedSer 
	    		  + ", volume: " + expectedVol
	    		  + ", issue: " + expectedIssue
	    		  + ", page: " + expectedPage
	    		  + ", tab_or_fig: " + expectedTabOrFig
	    		  + ", year: " + expectedYear
	    		  + ", rule: " + expectedRule
	    		  );
	    	*/
	      String[] parsedCollation =  cu.parseCollation(collation);
	      assertEquals(expectedSer, parsedCollation[CollationUtils.SERIES_INDEX]);
	      assertEquals(expectedVol, parsedCollation[CollationUtils.VOL_INDEX]);
	      assertEquals(expectedIssue, parsedCollation[CollationUtils.ISSUE_INDEX]);
	      assertEquals(expectedPage, parsedCollation[CollationUtils.PAGE_INDEX]);
	      assertEquals(expectedTabOrFig, parsedCollation[CollationUtils.TAB_OR_FIG_INDEX]);
	      assertEquals(expectedYear, parsedCollation[CollationUtils.YEAR_INDEX]);
	      assertEquals(expectedRule, parsedCollation[CollationUtils.RULE_INDEX]);

	      if (parsedCollation[CollationUtils.RULE_INDEX].equals(""))
	    	  System.out.println("Did not parse: " + collation);
	      
	      //assertNotSame("", parsedCollation[CollationUtils.RULE_INDEX]);
	      
	   }
	}